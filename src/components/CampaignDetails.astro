---
import Section from "./Section.astro";

interface PostItem {
  image: string;
  linkedInUrl: string;
  imagePosition?: string;
  aspectRatio?: string;
  colSpan?: string;
  title?: string;
  description?: string;
}

interface ContentPillar {
  title: string;
  description: string;
  posts?: PostItem[];
  linkText?: string;
  aspectRatio?: string;
  objectFit?: string;
  layoutClass?: string;
}

interface CampaignProps {
  id: string;
  name: string;
  pillars: ContentPillar[];
}

interface Props {
  campaigns: CampaignProps[];
}

const { campaigns } = Astro.props;
---

{
  campaigns.map((campaign) => (
    <section id={campaign.id} class="py-24 scroll-mt-20">
      <h2 class="mb-14 font-serif text-4xl font-bold tracking-tighter text-white md:text-5xl">
        {campaign.name}
      </h2>

      {/* Content pillar sections with posts */}
      {campaign.pillars.filter(pillar => pillar.posts && pillar.posts.length > 0).map((pillar) => (
        <div class="mt-16 rounded-2xl bg-[#f9f9f7] p-6 md:p-8">
          <h3 class="mb-4 font-serif text-2xl font-semibold text-white md:text-3xl">
            {pillar.title}
          </h3>
          <p class="mb-8 text-base text-neutral max-w-2xl">{pillar.description}</p>
          
          <div class={pillar.layoutClass || "grid gap-4 grid-cols-2 sm:grid-cols-3 lg:grid-cols-4"}>
            {pillar.posts?.map((post) => (
              <div class={`flex flex-col ${post.colSpan || ''}`}>
                {/* Card header: title + description */}
                {(post.title || post.description) && (
                  <div class="mb-4">
                    {post.title && (
                      <h4 class="mb-2 font-serif text-xl font-bold text-white">{post.title}</h4>
                    )}
                    {post.description && (
                      <p class="text-sm text-neutral">{post.description}</p>
                    )}
                  </div>
                )}
                {/* Image */}
                <div class={`${post.aspectRatio || pillar.aspectRatio || 'aspect-[9/16]'} w-full overflow-hidden rounded-xl border border-neutral/20 bg-neutral/10`}>
                  <img 
                    src={post.image} 
                    alt={post.title || `${pillar.title} post`}
                    class={`w-full ${(post.aspectRatio || pillar.aspectRatio) === 'aspect-auto' ? 'h-auto' : 'h-full'} ${pillar.objectFit || 'object-cover'} ${post.imagePosition || 'object-center'}`}
                  />
                </div>
                {/* CTA */}
                <a 
                  href={post.linkedInUrl}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="mt-4 text-sm text-primary hover:underline"
                >
                  {pillar.linkText || "View post on LinkedIn â†—"}
                </a>
              </div>
            ))}
          </div>
        </div>
      ))}
    </section>
  ))
}

